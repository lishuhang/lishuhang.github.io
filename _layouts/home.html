---
layout: base
---
<div class="flex justify-center py-8">
  <article class="text-center prose prose-p:font-extralight prose-slate dark:prose-invert primary-underline">
    {{ content }}
  </article>
</div>

<div class="md:w-4/5 mx-auto gap-4 columns-2 md:columns-3 mb-10" id="gallery-container">
  {% for post in site.posts %}
  <div class="post-item md:fadeIn pb-4 mb-4 break-inside-avoid-column relative group" data-index="{{ forloop.index0 }}">
    <div class="gallery-item">
      <a href="{{ post.url | relative_url }}" 
         class="square-container block relative overflow-hidden" 
         target="_blank" 
         rel="noopener noreferrer">
        <img src="{{ post.image | relative_url }}" 
             alt="" 
             class="square-image w-full h-full object-cover shadow-md">
        <div class="overlay absolute inset-0 bg-black/70 opacity-0 transition-opacity duration-300 group-hover:opacity-100 group-[.active]:opacity-100">
          <div class="text text-white p-4 flex flex-col h-full justify-center items-center">
            <h2 class="text-lg md:text-xl lg:text-2xl text-center mb-2">{{ post.title }}</h2>
            <div class="tags">
              {% for tag in post.tags limit:3 %}
              <span class="text-xs text-white/80">#{{ tag }}</span>
              {% endfor %}
            </div>
          </div>
        </div>
      </a>
    </div>
  </div>
  {% endfor %}
</div>

<!-- 新增加载更多按钮 -->
<div id="load-more-wrapper" class="text-center mt-6 mb-10">
  <a href="#" id="loadMoreBtn" class="load-more-button px-6 py-3 bg-slate-600 text-white rounded-lg hover:bg-slate-700 transition-colors">Load More</a>
</div>

<style>
  /* 原有样式保留 */
  .square-container {
    position: relative;
    width: 100%;
    padding-top: 100%;
  }
  
  .square-image {
    position: absolute;
    top: 0;
    left: 0;
    width: 100%;
    height: 100%;
  }

  .overlay {
    pointer-events: none;
  }
  
  .tags {
    display: flex;
    gap: 0.5rem;
    flex-wrap: wrap;
    justify-content: center;
  }

  /* 新增加载更多按钮样式 */
  .post-item {
    display: none;
  }
  
  .post-item:nth-child(-n+10) {
    display: block;
  }
</style>

<script>
  document.addEventListener('DOMContentLoaded', function() {
    const items = document.querySelectorAll('.post-item');
    const perPage = 10;
    let currentPage = 1;
    const totalItems = items.length;
    const loadMoreBtn = document.getElementById('loadMoreBtn');

    // 初始显示前10个项目
    items.forEach((item, index) => {
      if (index < perPage) item.style.display = 'block';
    });

    function checkButtonVisibility() {
      if (currentPage * perPage >= totalItems) {
        loadMoreBtn.style.display = 'none';
      }
    }

    function loadMore() {
      const start = currentPage * perPage;
      const end = start + perPage;
      items.forEach((item, index) => {
        if (index >= start && index < end) {
          item.style.display = 'block';
        }
      });
      currentPage++;
      checkButtonVisibility();
    }

    // 点击加载更多
    loadMoreBtn.addEventListener('click', function(e) {
      e.preventDefault();
      loadMore();
    });

    // 滚动加载
    window.addEventListener('scroll', () => {
      const { scrollTop, scrollHeight, clientHeight } = document.documentElement;
      if (scrollTop + clientHeight >= scrollHeight - 100) {
        loadMore();
      }
    });

    // 初始检查按钮可见性
    checkButtonVisibility();
  });

  // 保留原有移动端触摸处理逻辑
  document.querySelectorAll('.gallery-item').forEach(item => {
    // ... 原有移动端处理代码 ...
  });
</script>