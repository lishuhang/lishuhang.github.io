---
layout: base
---
<div class="flex justify-center py-8">
  <article class="text-center prose prose-p:font-extralight prose-slate dark:prose-invert primary-underline">
    {{ content }}
  </article>
</div>

<div class="w-full max-w-[1200px] mx-auto grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4 mb-10 px-4" id="gallery-container">
  <!-- 动态配置 -->
  {% assign exclude_tags = site.filter.exclude_tags | default: "" %}
  {% assign show_untagged = site.filter.show_untagged | default: true %}
  
  <!-- 分步过滤逻辑 -->
  {% assign filtered_posts = site.posts %}
  
  <!-- 第一步：处理标签排除 -->
  {% if exclude_tags.size > 0 %}
    {% assign target_tag = exclude_tags[0] %}
    {% assign filtered_posts = filtered_posts | where_exp: "post", 
      "post.tags == nil or post.tags contains target_tag != true" %}
  {% endif %}
  
  <!-- 第二步：处理无标签文章 -->
  {% unless show_untagged %}
    {% assign filtered_posts = filtered_posts | where_exp: "post", "post.tags.size > 0" %}
  {% endunless %}

  <!-- 渲染文章 -->
  {% for post in filtered_posts %}
  <div class="post-item md:fadeIn mb-4 break-inside-avoid relative" data-index="{{ forloop.index0 }}">
    <a href="{{ post.url | relative_url }}" 
       class="gallery-link block p-4 bg-white dark:bg-slate-800 rounded-lg shadow-md hover:shadow-lg transition-all duration-300 hover:-translate-y-1"
       target="_blank" 
       rel="noopener noreferrer">
      <div class="flex flex-col md:flex-row md:items-start gap-4">
        <div class="square-container md:w-[100px] flex-shrink-0">
          <img src="{{ post.image | relative_url }}" 
               alt="" 
               class="square-image w-full h-full object-cover rounded-md">
        </div>
        <div class="flex-1">
          <h2 class="text-lg md:text-xl lg:text-2xl mb-2 prose prose-slate dark:prose-invert">{{ post.title }}</h2>
          <div class="tags flex gap-2 flex-wrap">
            {% for tag in post.tags limit:3 %}
            <span class="text-xs text-slate-600 dark:text-slate-300">#{{ tag }}</span>
            {% endfor %}
          </div>
        </div>
      </div>
    </a>
  </div>
  {% endfor %}
</div>

<!-- 保留原有样式和脚本 -->